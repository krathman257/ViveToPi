#include <stdlib.h>
#include <thread>

#include "canvas.h"
#include "terminal.h"

int main(int, char**){
	//Clear terminal
	system("clear");

	//Initialize canvas
	Canvas canvas("/dev/fb1", "/dev/fb0", 0, "./Images/", "font2.png", true, false);
	Terminal terminal;
	std::vector<std::vector<std::string>> instructionList;

	//Clear Vive framebuffer
	canvas.fill(0, 0, 0);

	bool run = true;

	std::thread th(&Terminal::terminalThread, terminal, &canvas, &instructionList, &run);

	//Draw camera
	while(run){
		canvas.processInstructions(instructionList);
	}

	th.join();

	//Cleanup
	std::cout << "Closing ViveToPi..." << std::endl;
	canvas.closeAll();
	return 0;
}
